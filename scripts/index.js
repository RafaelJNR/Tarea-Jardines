const tareasGrupo1 =  [
    { 
      descripcion: "Tarea de prueba 1.",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["mangueras goteo integrado, sacabocados, tijeras de mano"],
      fechaAlta: "25/11",
      fechaBaja: "N/A",
      prioridad: "alta"
    },
    { 
      descripcion: "Tarea de prueba 2.",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["mangueras goteo integrado, sacabocados, tijeras de mano"],
      fechaAlta: "25/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },
    { 
      descripcion: "Tarea de prueba 3.",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["mangueras goteo integrado, sacabocados, tijeras de mano"],
      fechaAlta: "25/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },

];

const tareasGrupo2 =  [
    { 
      descripcion: "Ampliar aro riego palmera Bismarck.",
      parcela: "Talud",
      estado: "finalizada",
      herramientas: ["mangueras goteo integrado, sacabocados, tijeras de mano"],
      fechaAlta: "25/11",
      fechaBaja: "28/11",
      prioridad: "alta"
    },
    { 
      descripcion: "Reposición tres (3) tajinastes.",
      parcela: "C.G.",
      estado: "finalizada",
      herramientas: ["sacho", "compost", "ortiga"],
      fechaAlta: "25/11",
      fechaBaja: "01/12",
      prioridad: "media"
    },
    { 
      descripcion: "Plantar fajina.",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["sacho, martillo, fucha, pala de jardinería"],
      fechaAlta: "25/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },
    { 
      descripcion: "Instalar riego en la fajina.",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["mangueras goteo integrado, sacabocados, tijeras de mano"],
      fechaAlta: "25/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },
    { 
      descripcion: "Instalar caseta y plato para los pájaros.",
      parcela: "Talud",
      estado: "finalizada",
      herramientas: ["martillo, alcayatas, pala"],
      fechaAlta: "25/11",
      fechaBaja: "25/11",
      prioridad: "baja"
    },
    { 
      descripcion: "Limpieza de hojas y restos de escombros.",
      parcela: "Explanada",
      estado: "pendiente",
      herramientas: ["rastrillo de abanico", "sopladora"],
      fechaAlta: "25/11",
      fechaBaja: "N/A",
      prioridad: "media"
    },
    { 
      descripcion: "Sustitución manguera picada.",
      parcela: "talud",
      estado: "finalizada",
      herramientas: ["mangueras goteo integrado, sacabocados, tijeras de mano"],
      fechaAlta: "25/11",
      fechaBaja: "25/11",
      prioridad: "alta"
    },
    { 
      descripcion: "Instalar comedero y bebedero de pájaros",
      parcela: "Talud",
      estado: "finalizada",
      herramientas: ["martillo, alcayatas, pala"],
      fechaAlta: "27/11",
      fechaBaja: "01/12",
      prioridad: "baja"
    },
    { 
      descripcion: "Limpiar canaleta de agua",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["fucha, rastrillo de abanico, sacho"],
      fechaAlta: "27/11",
      fechaBaja: "N/A",
      prioridad: "alta"
    },
    { 
      descripcion: "Tratamiento trychoderma a los dragos",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["mochila pulverizadora"],
      fechaAlta: "27/11",
      fechaBaja: "N/A",
      prioridad: "media"
    },
    { 
      descripcion: "Traslado de las cactasias.",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["sacho, compost, oritga, pala de mano"],
      fechaAlta: "28/11",
      fechaBaja: "N/A",
      prioridad: "media"
    },
    { 
      descripcion: "Poda buganvilla.",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["tijera de poda, pico de loco, tijera de mano"],
      fechaAlta: "28/11",
      fechaBaja: "N/A",
      prioridad: "media"
    },
    { 
      descripcion: "Cambiar cintillo del entutorado de la plumeria",
      parcela: "Talud",
      estado: "finalizada",
      herramientas: ["tijera de mano"],
      fechaAlta: "28/11",
      fechaBaja: "28/11",
      prioridad: "alta"
    },
    { 
      descripcion: "Desbrozar adventicias respetando la camellera",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["fucha, sacho, rastrillo de puas"],
      fechaAlta: "28/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },
    { 
      descripcion: "Aporte y redistribución de picón",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["pala, rastrillo"],
      fechaAlta: "28/11",
      fechaBaja: "N/A",
      prioridad: "media"
    },
    { 
      descripcion: "Poda limpieza gaura",
      parcela: "Talud",
      estado: "pendiente",
      herramientas: ["tijera de mano"],
      fechaAlta: "28/11",
      fechaBaja: "N/A",
      prioridad: "media"
    },
    { 
      descripcion: "Ampliar alcorques de los ficus",
      parcela: "Explanada",
      estado: "finalizada",
      herramientas: ["sacho, rastrillo"],
      fechaAlta: "28/11",
      fechaBaja: "01/12",
      prioridad: "media"
    },
    { 
      descripcion: "Poda de los ficus",
      parcela: "Explanada",
      estado: "finalizada",
      herramientas: ["tijera de mano, pico de loro, tijeras de podar"],
      fechaAlta: "28/11",
      fechaBaja: "01/12",
      prioridad: "media"
    },
    { 
      descripcion: "Abono de los ficus",
      parcela: "Explanada",
      estado: "pendiente",
      herramientas: ["sacho, compost"],
      fechaAlta: "28/11",
      fechaBaja: "N/A",
      prioridad: "media"
    },
    { 
      descripcion: "Instalar riego de los ficus",
      parcela: "Explanada",
      estado: "pendiente",
      herramientas: ["mangueras goteo integrado, sacabocados, tijeras de mano"],
      fechaAlta: "28/11",
      fechaBaja: "N/A",
      prioridad: "media"
    },

];

const tareasGrupo3 =  [
    { 
      descripcion: "Conseguir un banco.",
      parcela: "Nuevo",
      estado: "pendiente",
      herramientas: ["martillo, sierra"],
      fechaAlta: "30/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },
    { 
      descripcion: "Montar pérgola.",
      parcela: "Nuevo",
      estado: "pendiente",
      herramientas: ["martillo, sierra"],
      fechaAlta: "30/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },
    { 
      descripcion: "Montar bebedero de pájaros en rocalla.",
      parcela: "Nuevo",
      estado: "pendiente",
      herramientas: ["martillo, sierra"],
      fechaAlta: "30/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },
    { 
      descripcion: "Colocar maceteros.",
      parcela: "Nuevo",
      estado: "pendiente",
      herramientas: [""],
      fechaAlta: "30/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },
    { 
      descripcion: "Revisar reposiciones.",
      parcela: "Nuevo",
      estado: "pendiente",
      herramientas: [""],
      fechaAlta: "30/11",
      fechaBaja: "N/A",
      prioridad: "baja"
    },

];

const gruposTareas = {
    "grupo1": tareasGrupo1.map(t => ({...t, grupo: "grupo 1"})),
    "grupo2": tareasGrupo2.map(t => ({...t, grupo: "grupo 2"})),
    "grupo3": tareasGrupo3.map(t => ({...t, grupo: "grupo 3"})),
};

const todasLasTareas = [
    ...gruposTareas.grupo1,
    ...gruposTareas.grupo2,
    ...gruposTareas.grupo3
];


function renderizarListaTareas(tareas, container) {
    container.innerHTML = ""; 

    if (tareas.length === 0) {
        container.innerHTML = "<p style='text-align: center; margin-top: 20px; width: 100%;'>❌ No se encontró la tarea especificada.</p>";
        return;
    }

    tareas.forEach((element) => {
        var li = document.createElement("li");
        li.classList.add("task-item");
        li.setAttribute('data-estado', element.estado);
        li.setAttribute('data-prioridad', element.prioridad); 

        var header = document.createElement("div");
        header.classList.add("task-header");

        var description = document.createElement("span");
        description.classList.add("task-description");
        description.textContent = element.descripcion;

        var date = document.createElement("span");
        date.classList.add("task-date");
        date.textContent = element.fechaAlta;
        
        header.appendChild(description);
        header.appendChild(date);

        var details = document.createElement("div");
        details.classList.add("task-details");

        const createDetailItem = (label, value) => {
            const div = document.createElement("div");
            div.classList.add("detail-item");
            div.innerHTML = `<strong>${label}:</strong> ${value}`;
            return div;
        };

        details.appendChild(createDetailItem("Prioridad", element.prioridad.toUpperCase()));
        details.appendChild(createDetailItem("Parcela", element.parcela));
        details.appendChild(createDetailItem("Estado", element.estado.toUpperCase()));
        details.appendChild(createDetailItem("Herramientas", element.herramientas.join(", ")));
        details.appendChild(createDetailItem("Fecha Baja", element.fechaBaja));
        details.appendChild(createDetailItem("Grupo", (element.grupo || 'N/A').toUpperCase())); 

        li.appendChild(header);
        li.appendChild(details);
        
        container.appendChild(li);
    });
}

function MostrarGrupos() {
    const grupoSeleccionado = document.getElementById("grupo-select").value;
    const tareasContainer = document.getElementById("grupos-container");
    tareasContainer.innerHTML = "";

    document.getElementById("tarea-input").value = "";

    if (grupoSeleccionado === "todos") {
        Object.keys(gruposTareas).forEach(grupoKey => {
            const tareasDelGrupo = gruposTareas[grupoKey];
            const grupoDisplay = "Grupo " + grupoKey.replace('grupo', '');

            const titulo = document.createElement("h2");
            titulo.classList.add("group-title");
            titulo.textContent = `${grupoDisplay} (${tareasDelGrupo.length} tareas)`;
            tareasContainer.appendChild(titulo);

            const ul = document.createElement("ul");
            ul.classList.add("content"); 
            tareasContainer.appendChild(ul);
            
            renderizarListaTareas(tareasDelGrupo, ul);
        });
    } else {

        const tareasDelGrupo = gruposTareas[grupoSeleccionado];
        const grupoDisplay = "Grupo " + grupoSeleccionado.replace('grupo', '');

        const titulo = document.createElement("h2");
        titulo.classList.add("group-title");
        titulo.textContent = `${grupoDisplay} (${tareasDelGrupo.length} tareas)`;
        tareasContainer.appendChild(titulo);

        const ul = document.createElement("ul");
        ul.classList.add("content");
        tareasContainer.appendChild(ul);
        
        renderizarListaTareas(tareasDelGrupo, ul);
    }
}


function EncontrarTarea(){
    const busqueda = document.getElementById("tarea-input").value.toLowerCase().trim();
    const grupoSeleccionado = document.getElementById("grupo-select").value;
    const tareasContainer = document.getElementById("grupos-container");
    tareasContainer.innerHTML = ""; 

    if (busqueda === "") {
        MostrarGrupos();
        return;
    }

    let tareasAFiltro = [];
    let grupoKeyLabel = "Todos los Grupos";

    if (grupoSeleccionado === "todos") {
        tareasAFiltro = todasLasTareas;
    } else {
        tareasAFiltro = gruposTareas[grupoSeleccionado] || [];
        grupoKeyLabel = "Grupo " + grupoSeleccionado.replace('grupo', '');
    }

    const tareasFiltradas = tareasAFiltro.filter(tarea => 
        tarea.descripcion.toLowerCase().includes(busqueda) || 
        tarea.parcela.toLowerCase().includes(busqueda) ||
        tarea.prioridad.toLowerCase().includes(busqueda)
    );

    const titulo = document.createElement("h2");
    titulo.classList.add("group-title", "search-results-title");
    titulo.textContent = `Resultados de Búsqueda en ${grupoKeyLabel} (${tareasFiltradas.length} tareas)`;
    tareasContainer.appendChild(titulo);

    const ul = document.createElement("ul");
    ul.classList.add("content");
    tareasContainer.appendChild(ul);

    renderizarListaTareas(tareasFiltradas, ul);
}

MostrarGrupos();